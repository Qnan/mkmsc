\section{Методы построения схем\label{s:methods}}
	\subsection{Структура схемы\label{ss:split}}
	Существуют методы, которые строят упрощенные, в некотором смысле, схемы вычисления. В корневых узлах такой схемы стоят не первые степени переменных, а некоторые мономы, которые, в свою очередь, могут быть вычислены различными способами. Соответственно, для них строится отдельная схема, называемая схемой \textit{совместного вычисления мономов}.
	
	\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.6]{../pic/split}
	\caption{Схема для $x^2y^3+xy^4$ как композиция двух схем. Пунктиром выделен переход.}
	\label{fig:split}
	\end{figure}

	Можно рассматривать это как разбиение схемы на две части (рис. \ref{fig:split}). Формально они отличаются лишь тем, что нижняя не содержит операций сложения. Методы построения схем совместного вычисления мономов мы рассмотрим в разделе \ref{ss:monomials}.	

	\subsection{Задача построения оптимальной схемы и ее сложность\label{ss:complexity}}
		Пусть задан критерий качества $f: s\rightarrow h, s\in S, h\in \mathbb{R}$, где $S$ -- множество возможных схем. Необходимо для заданного полинома $p(\bar{x})=\sum_i{c_i\bar{x}^{\bar{\alpha}_i}}$ построить отвечающую ему схему с наибольшим возможным $h$.
		
		[сложность]
		
	\subsection{Обобщенный метод Горнера\label{ss:gorner}}
		Обобщенный (на случай полиномов многих переменных) метод Горнера прост в реализации и позволяет получать достатчно хорошие схемы. Алгоритм построения \ref{alg:horner} является рекурсивным. Фактически, он представляет исходный полином $t$ в виде $t=pd+q$, причем ни один член $q$ не делится на $d$. Затем операция повторяется для $p$ и $q$, до тех пор, пока на месте $t$ не окажется одночленом.
		
		Легко видеть, что число рекурсивных вызовов не превышает число членов в исходном полиноме. Сложность каждого вызова составляет $O(n)$ операций вычисления наибольшего общего делителя двух одночленов $GCD$. Всего не более $O(n^2)$ операций $GCD$. Сложность одной такой операции можно считать постоянной, если ограничить величину коэффициентов некоторой константой и зафиксировать число переменных.
				
\begin{algorithm}
\SetAlgoNoLine
\DontPrintSemicolon
\KwIn{список $T$ членов полинома в порядке убывания, контейнер схемы $S$}
$P\leftarrow \{\}$\;
$d\leftarrow T[0]$\;
\If{Length(T)$=1$}{
\Return{\textit{AddNode}$(S,T[0])$}
}
\ForEach{$t\in T$} {
	$g\leftarrow $\textit{GCD}$(t,d)$\;
	\If{TotalDegree$(g)>0$}{
		$P\leftarrow P\cup\{t\}$\;
		$d\leftarrow g$\;
	}
}
$Q\leftarrow T\setminus P$\;
$P'\leftarrow \{\}$\;
\ForEach{$t\in P$}{
		$P'\leftarrow P'\cup\{t/d\}$\;
}
$N_p\leftarrow $\textit{Horner}$(P',S)$ \tcp*[l]{recursive call} 
$N_d\leftarrow $\textit{AddNode}$(S,d)$\;
$N_p\leftarrow $\textit{AddNode}$(S,\left\langle *,N_d,N_p \right\rangle)$\;
\If{$Q\neq\emptyset$}{
$N_q\leftarrow $\textit{Horner}$(Q,S)$ \;
$N_p\leftarrow $\textit{AddNode}$(S,\left\langle +,N_p,N_q \right\rangle)$\;
}
\Return{p}

\label{alg:horner}
\caption{\textsc{Horner(T,S)}}
\end{algorithm}

[пример]
		
	\subsection{Метод минимального покрывающего дерева\label{ss:htree}}
	Стоимость операции сложения и умножения на число обычно не превышают стоимости умножения полиномов. Попробуем временно <<забыть>> эти операции и строить схему для \textit{носителя} $M$ полинома -- множества его мономов. Также, пусть $V$ -- множество переменных рассматриваемого полинома.
	
	Рассмотрим орграф по отношению делимости на множестве $M'=M\cup V$ с весами на ребрах, равными некоторой функции частного, например, его полной степени. Нам необходимо выбрать некоторое подмножество ребер этого графа, которое будет отвечать схеме вычисления рассматриваемого набора мономов. Подмножество должно быть таким, чтобы каждый узел из $M\setminus V$ имел ровно одно входящее ребро, с тем чтобы не вычислять один и тот же моном дважды. Заметим, что такое подмножество всегда существует, так как каждый элемент $M\setminus V$ делится на хотя бы один элемент $V$. Пример построения можно видеть на рисунке \ref{fig:mintree}. Здесь для краткости опущены все дуги, кроме соединяющих мономы на соседних уровнях.

	\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.9]{../pic/mintree}
	\caption{Граф делимости (неполный). Черные дуги порождают схему.}
	\label{fig:mintree}
	\end{figure}
	
	Среди всех возможных подмножеств, отвечающих данным критериям, мы выберем одно, обладающее наименьшим весом, и обозначим соответствующий подграф $G_{min}$. Заметим, что название метода не отвечает структуре, которую мы построили -- последняя представляет собой не дерево, а лес из $|V|$ деревьев, причем каждое из деревьев может не являться минимальным покрывающим деревом соответствующего подграфа, в силу ограничения на количество входящих ребер. Тем не менее, аналогия с задачей о минимальном покрывающем дереве кажется нам достаточно ясной.

	Преобразуем, далее, выбранное подмножество в схему. Схема будет содержать по одной операции умножения на каждое ребро $G_{min}$. Ясно, что множители, отвечающие каждому ребру (частное мономов в соседних узлах), входят во множество корневых мономов. Также туда входят первые степени всех переменных, за исключением тех, которые оказались изолированными в $G_{min}$, как, например, моном $(0,1,0)$ на рис. \ref{fig:mintree}. Пример получающейся схемы изображен на рис. \ref{fig:mintreescheme}
	
	\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.9]{../pic/mintreescheme}
	\caption{Схема, построенная по графу на рис. \ref{fig:mintree}. Серым выделены добавочные корневые мономы.}
	\label{fig:mintreescheme}
	\end{figure}

	После того, как подмножество наименьшего веса выбрано, нам остается добавить операции, соответствующие умножению на коэффициенты и суммированию, а также построить схему для вычисления корневых мономов. Очевидно, в данном случае разделение схемы на две части выглядит несколько нелогично. Мы обсудим этот момент и его влияние на эффективность схемы в разд. \ref{ss:monomials}.

%\begin{algorithm}
%\SetAlgoNoLine
%\DontPrintSemicolon
%\KwIn{список $T$ членов полинома в порядке убывания, контейнер схемы $S$}
%$М\leftarrow $\textit{список мономов из Т без коэффициентов}\;
%$V\leftarrow $\textit{список переменных}\;
%$M'\leftarrow M\cup V$\;
%$E\leftarrow \{\}$\;
%\ForEach{$m\in M'$} {
%	$q\leftarrow$ \textit{argmax}$($\textit{TotalDeg}$(q)), q\in M' \& m\vdots q$\;
%	
%}
%
%\ForEach{$t\in T$} {
%	$g\leftarrow $\textit{GCD}$(t,d)$\;
%	\If{TotalDegree$(g)>0$}{
%		$P\leftarrow P\cup\{t\}$\;
%		$d\leftarrow g$\;
%	}
%}
%$Q\leftarrow T\setminus P$\;
%$P'\leftarrow \{\}$\;
%\ForEach{$t\in P$}{
%		$P'\leftarrow P'\cup\{t/d\}$\;
%}
%$N_p\leftarrow $\textit{Horner}$(P',S)$ \tcp*[l]{recursive call} 
%$N_d\leftarrow $\textit{AddNode}$(S,d)$\;
%$N_p\leftarrow $\textit{AddNode}$(S,\left\langle *,N_d,N_p \right\rangle)$\;
%\If{$Q\neq\emptyset$}{
%$N_q\leftarrow $\textit{Horner}$(Q,S)$ \;
%$N_p\leftarrow $\textit{AddNode}$(S,\left\langle +,N_p,N_q \right\rangle)$\;
%}
%\Return{p}
%
%\label{alg:horner}
%\caption{\textsc{MinTree(T,S)}}
%\end{algorithm}


[задача Штейнера]
[пример]

	\subsection{Совместное вычисление мономов\label{ss:monomials}}
		...
	\subsection{Комбинированный метод\label{ss:hybrid}}
		...
	\subsection{Схемы специального вида\label{ss:special}}
		...
		\subsection{Оптимальная схема для плотного полинома\label{sss:dense}}
			[как строится, почему оптимальная, частный случай mintree]